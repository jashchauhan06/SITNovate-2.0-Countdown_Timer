{"ast":null,"code":"import { db } from '../firebase';\nimport { ref, set, onValue, get } from 'firebase/database';\nconst TIMER_REF = 'timer';\nconst DEFAULT_STATE = {\n  isRunning: false,\n  endTime: null,\n  remainingTime: 24 * 60 * 60 * 1000\n};\n\n// Write timer state to Firebase\nexport function saveTimerState(state) {\n  return set(ref(db, TIMER_REF), state);\n}\n\n// One-time read of timer state\nexport async function getTimerState() {\n  const snapshot = await get(ref(db, TIMER_REF));\n  return snapshot.exists() ? snapshot.val() : {\n    ...DEFAULT_STATE\n  };\n}\n\n// Real-time listener — calls callback whenever timer state changes in Firebase\nexport function subscribeToTimer(callback) {\n  const timerRef = ref(db, TIMER_REF);\n  const unsubscribe = onValue(timerRef, snapshot => {\n    const state = snapshot.exists() ? snapshot.val() : {\n      ...DEFAULT_STATE\n    };\n    callback(state);\n  });\n  return unsubscribe;\n}\n\n// GitHub Push Timer\nconst GITHUB_TIMER_REF = 'githubPushTimer';\nconst THREE_HOURS = 3 * 60 * 60 * 1000;\n\n// Save GitHub timer data to Firebase\nexport function saveGitHubTimer(endTime, pushCount) {\n  return set(ref(db, GITHUB_TIMER_REF), {\n    endTime,\n    pushCount\n  });\n}\n\n// Get GitHub timer data\nexport async function getGitHubTimer() {\n  const snapshot = await get(ref(db, GITHUB_TIMER_REF));\n  if (snapshot.exists()) {\n    return snapshot.val();\n  }\n  // Initialize with 3 hours from now if not exists\n  const newEndTime = Date.now() + THREE_HOURS;\n  await saveGitHubTimer(newEndTime, 1);\n  return {\n    endTime: newEndTime,\n    pushCount: 1\n  };\n}\n\n// Real-time listener for GitHub timer\nexport function subscribeToGitHubTimer(callback) {\n  const timerRef = ref(db, GITHUB_TIMER_REF);\n  const unsubscribe = onValue(timerRef, async snapshot => {\n    let data;\n    if (snapshot.exists()) {\n      data = snapshot.val();\n      // Ensure pushCount exists, default to 1 if missing\n      if (!data.pushCount) {\n        data.pushCount = 1;\n        await saveGitHubTimer(data.endTime, 1);\n      }\n    } else {\n      const endTime = Date.now() + THREE_HOURS;\n      data = {\n        endTime,\n        pushCount: 1\n      };\n      await saveGitHubTimer(endTime, 1);\n    }\n    callback(data.endTime, data.pushCount);\n  });\n  return unsubscribe;\n}\n\n// Reset GitHub timer (add 3 hours from now and increment count)\nexport async function resetGitHubTimer() {\n  const currentData = await getGitHubTimer();\n  const newEndTime = Date.now() + THREE_HOURS;\n  const newPushCount = currentData.pushCount + 1;\n  await saveGitHubTimer(newEndTime, newPushCount);\n  return {\n    endTime: newEndTime,\n    pushCount: newPushCount\n  };\n}","map":{"version":3,"names":["db","ref","set","onValue","get","TIMER_REF","DEFAULT_STATE","isRunning","endTime","remainingTime","saveTimerState","state","getTimerState","snapshot","exists","val","subscribeToTimer","callback","timerRef","unsubscribe","GITHUB_TIMER_REF","THREE_HOURS","saveGitHubTimer","pushCount","getGitHubTimer","newEndTime","Date","now","subscribeToGitHubTimer","data","resetGitHubTimer","currentData","newPushCount"],"sources":["J:/Github/SITNovate-2.0-Countdown_Timer/src/utils/timerStorage.js"],"sourcesContent":["import { db } from '../firebase';\r\nimport { ref, set, onValue, get } from 'firebase/database';\r\n\r\nconst TIMER_REF = 'timer';\r\n\r\nconst DEFAULT_STATE = {\r\n  isRunning: false,\r\n  endTime: null,\r\n  remainingTime: 24 * 60 * 60 * 1000\r\n};\r\n\r\n// Write timer state to Firebase\r\nexport function saveTimerState(state) {\r\n  return set(ref(db, TIMER_REF), state);\r\n}\r\n\r\n// One-time read of timer state\r\nexport async function getTimerState() {\r\n  const snapshot = await get(ref(db, TIMER_REF));\r\n  return snapshot.exists() ? snapshot.val() : { ...DEFAULT_STATE };\r\n}\r\n\r\n// Real-time listener — calls callback whenever timer state changes in Firebase\r\nexport function subscribeToTimer(callback) {\r\n  const timerRef = ref(db, TIMER_REF);\r\n  const unsubscribe = onValue(timerRef, (snapshot) => {\r\n    const state = snapshot.exists() ? snapshot.val() : { ...DEFAULT_STATE };\r\n    callback(state);\r\n  });\r\n  return unsubscribe;\r\n}\r\n\r\n// GitHub Push Timer\r\nconst GITHUB_TIMER_REF = 'githubPushTimer';\r\nconst THREE_HOURS = 3 * 60 * 60 * 1000;\r\n\r\n// Save GitHub timer data to Firebase\r\nexport function saveGitHubTimer(endTime, pushCount) {\r\n  return set(ref(db, GITHUB_TIMER_REF), { endTime, pushCount });\r\n}\r\n\r\n// Get GitHub timer data\r\nexport async function getGitHubTimer() {\r\n  const snapshot = await get(ref(db, GITHUB_TIMER_REF));\r\n  if (snapshot.exists()) {\r\n    return snapshot.val();\r\n  }\r\n  // Initialize with 3 hours from now if not exists\r\n  const newEndTime = Date.now() + THREE_HOURS;\r\n  await saveGitHubTimer(newEndTime, 1);\r\n  return { endTime: newEndTime, pushCount: 1 };\r\n}\r\n\r\n// Real-time listener for GitHub timer\r\nexport function subscribeToGitHubTimer(callback) {\r\n  const timerRef = ref(db, GITHUB_TIMER_REF);\r\n  const unsubscribe = onValue(timerRef, async (snapshot) => {\r\n    let data;\r\n    if (snapshot.exists()) {\r\n      data = snapshot.val();\r\n      // Ensure pushCount exists, default to 1 if missing\r\n      if (!data.pushCount) {\r\n        data.pushCount = 1;\r\n        await saveGitHubTimer(data.endTime, 1);\r\n      }\r\n    } else {\r\n      const endTime = Date.now() + THREE_HOURS;\r\n      data = { endTime, pushCount: 1 };\r\n      await saveGitHubTimer(endTime, 1);\r\n    }\r\n    callback(data.endTime, data.pushCount);\r\n  });\r\n  return unsubscribe;\r\n}\r\n\r\n// Reset GitHub timer (add 3 hours from now and increment count)\r\nexport async function resetGitHubTimer() {\r\n  const currentData = await getGitHubTimer();\r\n  const newEndTime = Date.now() + THREE_HOURS;\r\n  const newPushCount = currentData.pushCount + 1;\r\n  await saveGitHubTimer(newEndTime, newPushCount);\r\n  return { endTime: newEndTime, pushCount: newPushCount };\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}